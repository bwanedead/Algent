/* --- SHELL & ATMOSPHERE --- */

.hud-shell {
  position: relative;
  min-height: 100vh;
  width: 100vw;
  background: radial-gradient(circle at 50% 30%, #1c1917 0%, #0c0a09 80%);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  /* Default cursor pos to center if JS hasn't loaded */
  --cursor-x: 50vw;
  --cursor-y: 50vh;
}

/* --- GRID LAYERS --- */

.hud-grid-layer {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

/* 1. Base Snap Grid (Thin, sharp, flashlight reveal) */
.base-grid {
  background-image: 
    linear-gradient(to right, rgba(255, 255, 255, 0.08) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(255, 255, 255, 0.08) 1px, transparent 1px);
  background-size: var(--s-grid) var(--s-grid);
  
  /* Flashlight mask */
  mask-image: radial-gradient(
    circle calc(var(--hud-mask-base) + var(--hud-mask-debug-radius)) at var(--cursor-x) var(--cursor-y),
    black 0%,
    transparent 100%
  );
}

.micro-grid {
  background-image:
    linear-gradient(to right, rgba(255, 255, 255, 0.045) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(255, 255, 255, 0.045) 1px, transparent 1px);
  background-size: var(--hud-grid-quarter) var(--hud-grid-quarter);
  opacity: 0.2;
  mask-image: radial-gradient(
    circle calc(var(--hud-mask-meta) + var(--hud-mask-debug-radius)) at var(--cursor-x) var(--cursor-y),
    black 10%,
    transparent 100%
  );
}

/* 2. Meta Grid (3x3 units, scattered/broken style) */
.meta-grid {
  /* 3x3 = 120px if base is 40px */
  background-image: 
    radial-gradient(circle at 2px 2px, var(--c-accent-faded) 2px, transparent 2px);
  background-size: calc(var(--s-grid) * 3) calc(var(--s-grid) * 3);
  opacity: 0.3;
  
  /* Secondary wider flashlight */
  mask-image: radial-gradient(
    circle calc(var(--hud-mask-meta) + var(--hud-mask-debug-radius)) at var(--cursor-x) var(--cursor-y),
    black 20%,
    transparent 80%
  );
}

/* 3. Trace Layer - Inherits Flashlight Mask */
.trace-layer {
  /* Same flashlight mask as base-grid so traces only show near cursor */
  mask-image: radial-gradient(
    circle calc(var(--hud-mask-trace) + var(--hud-mask-debug-radius)) at var(--cursor-x) var(--cursor-y),
    black 20%,
    transparent 100%
  );
  z-index: 1; /* Above base grid */
}

.hud-noise {
  position: absolute;
  inset: 0;
  opacity: 0.08;
  pointer-events: none;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
  mix-blend-mode: overlay;
  z-index: 2;
}

.hud-scanlines {
  position: absolute;
  inset: 0;
  background: repeating-linear-gradient(
    to bottom,
    transparent 0px,
    transparent 3px,
    rgba(0, 0, 0, 0.3) 4px
  );
  pointer-events: none;
  z-index: 2;
  opacity: 0.4;
}

/* --- MAIN LAYOUT --- */

.hud-frame {
  position: relative;
  flex: 1;
  display: flex;
  flex-direction: column;
  z-index: 10;
  padding: var(--s-grid);
  gap: calc(var(--s-grid) * 0.4);
}

/* --- HEADER --- */

.hud-header {
  display: flex;
  align-items: flex-end;
  gap: calc(var(--s-grid) * 0.6);
  padding-bottom: calc(var(--s-grid) * 0.3);
  border-bottom: 1px solid transparent;
  background-image: linear-gradient(to right, var(--c-border-dim) 50%, transparent 50%);
  background-position: bottom left;
  background-size: var(--hud-grid-quarter) 1px;
  background-repeat: repeat-x;
}

.hud-title-block {
  flex: 1;
}

.hud-label {
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.15em;
  color: var(--c-text-dim);
  font-weight: 600;
}

.hud-title {
  font-size: 1.5rem;
  font-weight: 400;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--c-text-main);
  text-shadow: 0 0 15px rgba(251, 146, 60, 0.2);
}

.hud-status-block {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
}

.hud-value {
  font-size: 1rem;
  color: var(--c-accent-amber);
  letter-spacing: 0.05em;
}

.hud-value--online {
  color: var(--c-accent-ok);
}

/* --- CANVAS AREA --- */

.hud-canvas {
  flex: 1;
  position: relative;
  overflow: hidden;
  display: grid;
  place-items: center;
  padding: calc(var(--s-grid) * 0.25);
}

.hud-caption {
  position: absolute;
  bottom: calc(var(--s-grid) * 0.3);
  left: calc(var(--s-grid) * 0.3);
  font-size: 0.75rem;
  color: var(--c-text-dim);
  background: rgba(0,0,0,0.4);
  padding: 4px 8px;
  border-left: 2px solid var(--c-accent-faded);
}
.hud-caption span { color: var(--c-accent-amber); margin-left: 8px; }

/* --- FOOTER --- */

.hud-footer {
  display: flex;
  justify-content: space-between;
  padding-top: calc(var(--s-grid) * 0.3);
  background-image: linear-gradient(to right, var(--c-border-dim) 50%, transparent 50%);
  background-position: top left;
  background-size: var(--hud-grid-quarter) 1px;
  background-repeat: repeat-x;
}

.hud-footer-block {
  display: flex;
  gap: 12px;
  align-items: baseline;
  font-size: 0.8rem;
  color: var(--c-text-dim);
}
.hud-footer-block .hud-value {
  color: var(--c-text-muted);
  font-size: 0.8rem;
}

/* --- ANIMATIONS --- */

@keyframes growX {
  from { transform: scaleX(0); }
  to { transform: scaleX(1); }
}

@keyframes growY {
  from { transform: scaleY(0); }
  to { transform: scaleY(1); }
}
